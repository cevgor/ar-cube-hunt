<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–•—Ä–æ–Ω–∏–∫–∏ –ø–∞–¥–∞—é—â–∏—Ö –∑–≤—ë–∑–¥ | –•–∞—Ä–¥–∫–æ—Ä</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #0ff;
            font-family: 'Courier New', monospace;
            overflow: hidden;
            user-select: none;
        }
        
        #gameContainer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        #ui {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            pointer-events: none;
        }
        
        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(0, 5, 15, 0.8);
            transition: opacity 0.5s;
        }
        
        .hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        h1 {
            font-size: 3.5rem;
            margin-bottom: 2rem;
            text-shadow: 0 0 10px #0ff, 0 0 20px #0ff;
            text-align: center;
        }
        
        h2 {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            text-shadow: 0 0 5px #0ff;
        }
        
        .btn {
            background: transparent;
            color: #0ff;
            border: 2px solid #0ff;
            padding: 12px 30px;
            margin: 10px;
            font-size: 1.2rem;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            pointer-events: auto;
            transition: all 0.3s;
            text-shadow: 0 0 5px #0ff;
            box-shadow: 0 0 10px #0ff;
        }
        
        .btn:hover {
            background: rgba(0, 255, 255, 0.2);
            box-shadow: 0 0 20px #0ff;
        }
        
        .hud {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 1.2rem;
            text-shadow: 0 0 5px #0ff;
        }
        
        .resources {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 1.2rem;
            text-shadow: 0 0 5px #0ff;
            text-align: right;
        }
        
        .controls {
            position: absolute;
            bottom: 20px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        
        .control-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: rgba(0, 255, 255, 0.2);
            border: 2px solid #0ff;
            color: #0ff;
            font-size: 1.5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            pointer-events: auto;
            cursor: pointer;
            box-shadow: 0 0 10px #0ff;
        }
        
        .upgrades {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        
        .upgrade {
            background: rgba(0, 20, 40, 0.7);
            border: 1px solid #0ff;
            padding: 15px;
            pointer-events: auto;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .upgrade:hover {
            background: rgba(0, 40, 80, 0.7);
            box-shadow: 0 0 10px #0ff;
        }
        
        .upgrade-name {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }
        
        .upgrade-level {
            font-size: 0.9rem;
            color: #8ff;
        }
        
        .upgrade-cost {
            font-size: 0.9rem;
            color: #f80;
            margin-top: 5px;
        }
        
        .leaderboard {
            max-height: 300px;
            overflow-y: auto;
            margin: 20px 0;
            width: 300px;
        }
        
        .leaderboard-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 15px;
            border-bottom: 1px solid #044;
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                rgba(255,255,255,0) 0%,
                rgba(255,255,255,0.06) 50%,
                rgba(255,255,255,0) 100%
            );
            background-size: 100% 4px;
            z-index: 3;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div id="gameContainer"></div>
    <div id="ui">
        <div class="scanlines"></div>
        
        <div id="menuScreen" class="screen">
            <h1>–•–†–û–ù–ò–ö–ò –ü–ê–î–ê–Æ–©–ò–• –ó–í–Å–ó–î</h1>
            <p style="margin-bottom: 30px; font-size: 1.2rem; text-align: center;">–ü—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–π –∫–æ—Å–º–∏—á–µ—Å–∫–∏–π —Ö–∞—Ä–¥–∫–æ—Ä</p>
            <button id="startBtn" class="btn">–°–¢–ê–†–¢</button>
            <button id="upgradesBtn" class="btn">–£–õ–£–ß–®–ï–ù–ò–Ø</button>
            <button id="recordsBtn" class="btn">–†–ï–ö–û–†–î–´</button>
        </div>
        
        <div id="gameScreen" class="screen hidden">
            <div class="hud">
                <div>–ó–î–û–†–û–í–¨–ï: <span id="healthValue">100</span>%</div>
                <div>–≠–ù–ï–†–ì–ò–Ø: <span id="energyValue">100</span>%</div>
                <div>–°–ö–û–†–û–°–¢–¨: <span id="speedValue">0</span></div>
            </div>
            
            <div class="resources">
                <div>–ó–í–Å–ó–î–´: <span id="starsValue">0</span></div>
                <div>–û–ë–õ–û–ú–ö–ò: <span id="fragmentsValue">0</span></div>
                <div>–û–ß–ö–ò: <span id="scoreValue">0</span></div>
            </div>
            
            <div class="controls">
                <div class="control-btn" id="leftBtn">‚Üê</div>
                <div class="control-btn" id="shieldBtn">üõ°Ô∏è</div>
                <div class="control-btn" id="rightBtn">‚Üí</div>
            </div>
        </div>
        
        <div id="upgradesScreen" class="screen hidden">
            <h2>–£–õ–£–ß–®–ï–ù–ò–Ø</h2>
            <div class="upgrades">
                <div class="upgrade" data-upgrade="engine">
                    <div class="upgrade-name">–î–í–ò–ì–ê–¢–ï–õ–¨</div>
                    <div class="upgrade-level">–£—Ä–æ–≤–µ–Ω—å: <span id="engineLevel">1</span></div>
                    <div class="upgrade-cost">–°—Ç–æ–∏–º–æ—Å—Ç—å: <span id="engineCost">10</span> –∑–≤—ë–∑–¥</div>
                </div>
                <div class="upgrade" data-upgrade="shield">
                    <div class="upgrade-name">–©–ò–¢</div>
                    <div class="upgrade-level">–£—Ä–æ–≤–µ–Ω—å: <span id="shieldLevel">1</span></div>
                    <div class="upgrade-cost">–°—Ç–æ–∏–º–æ—Å—Ç—å: <span id="shieldCost">15</span> –∑–≤—ë–∑–¥</div>
                </div>
                <div class="upgrade" data-upgrade="weapon">
                    <div class="upgrade-name">–û–†–£–ñ–ò–ï</div>
                    <div class="upgrade-level">–£—Ä–æ–≤–µ–Ω—å: <span id="weaponLevel">1</span></div>
                    <div class="upgrade-cost">–°—Ç–æ–∏–º–æ—Å—Ç—å: <span id="weaponCost">20</span> –∑–≤—ë–∑–¥</div>
                </div>
                <div class="upgrade" data-upgrade="scanner">
                    <div class="upgrade-name">–°–ö–ê–ù–ï–†</div>
                    <div class="upgrade-level">–£—Ä–æ–≤–µ–Ω—å: <span id="scannerLevel">1</span></div>
                    <div class="upgrade-cost">–°—Ç–æ–∏–º–æ—Å—Ç—å: <span id="scannerCost">25</span> –∑–≤—ë–∑–¥</div>
                </div>
            </div>
            <button id="backFromUpgradesBtn" class="btn">–ù–ê–ó–ê–î</button>
        </div>
        
        <div id="recordsScreen" class="screen hidden">
            <h2>–¢–ê–ë–õ–ò–¶–ê –†–ï–ö–û–†–î–û–í</h2>
            <div class="leaderboard" id="leaderboard">
                <!-- –ó–∞–ø–æ–ª–Ω–∏—Ç—Å—è JavaScript -->
            </div>
            <button id="backFromRecordsBtn" class="btn">–ù–ê–ó–ê–î</button>
        </div>
        
        <div id="gameOverScreen" class="screen hidden">
            <h2>–ö–û–†–ê–ë–õ–¨ –£–ù–ò–ß–¢–û–ñ–ï–ù</h2>
            <p style="font-size: 1.5rem; margin: 20px 0;">–í–∞—à —Å—á—ë—Ç: <span id="finalScore">0</span></p>
            <button id="restartBtn" class="btn">–ù–û–í–ê–Ø –ò–ì–†–ê</button>
            <button id="menuFromGameOverBtn" class="btn">–ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ</button>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Three.js
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 2000);
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–Ω–¥–µ—Ä–µ—Ä–∞
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(0x000011, 1);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        document.getElementById('gameContainer').appendChild(renderer.domElement);
        
        // –û—Å–≤–µ—â–µ–Ω–∏–µ
        const ambientLight = new THREE.AmbientLight(0x333355);
        scene.add(ambientLight);
        
        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
        directionalLight.position.set(1, 1, 1);
        directionalLight.castShadow = true;
        directionalLight.shadow.mapSize.width = 2048;
        directionalLight.shadow.mapSize.height = 2048;
        scene.add(directionalLight);
        
        // –ó–≤—ë–∑–¥–Ω–æ–µ –Ω–µ–±–æ
        const starGeometry = new THREE.BufferGeometry();
        const starCount = 10000;
        const starPositions = new Float32Array(starCount * 3);
        
        for (let i = 0; i < starCount * 3; i += 3) {
            starPositions[i] = (Math.random() - 0.5) * 2000;
            starPositions[i + 1] = (Math.random() - 0.5) * 2000;
            starPositions[i + 2] = (Math.random() - 0.5) * 2000;
        }
        
        starGeometry.setAttribute('position', new THREE.BufferAttribute(starPositions, 3));
        
        const starMaterial = new THREE.PointsMaterial({
            color: 0xffffff,
            size: 1,
            sizeAttenuation: true
        });
        
        const stars = new THREE.Points(starGeometry, starMaterial);
        scene.add(stars);
        
        // –¢—É–º–∞–Ω–Ω–æ—Å—Ç—å
        const nebulaGeometry = new THREE.SphereGeometry(800, 32, 32);
        const nebulaMaterial = new THREE.MeshBasicMaterial({
            color: 0x330066,
            transparent: true,
            opacity: 0.1,
            side: THREE.BackSide
        });
        
        const nebula = new THREE.Mesh(nebulaGeometry, nebulaMaterial);
        scene.add(nebula);
        
        // –ö–æ—Ä–∞–±–ª—å –∏–≥—Ä–æ–∫–∞
        const shipGeometry = new THREE.ConeGeometry(3, 10, 4);
        const shipMaterial = new THREE.MeshPhongMaterial({
            color: 0x00aaff,
            shininess: 100,
            emissive: 0x002266
        });
        
        const ship = new THREE.Mesh(shipGeometry, shipMaterial);
        ship.rotation.x = Math.PI / 2;
        ship.position.z = 15;
        ship.castShadow = true;
        scene.add(ship);
        
        // –¢—Ä–∞—Å—Å–∏—Ä—É—é—â–∏–µ –ª–∏–Ω–∏–∏ –∑–∞ –∫–æ—Ä–∞–±–ª–µ–º
        const trailGeometry = new THREE.BufferGeometry();
        const trailPositions = new Float32Array(300); // 100 —Ç–æ—á–µ–∫ –ø–æ 3 –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
        trailGeometry.setAttribute('position', new THREE.BufferAttribute(trailPositions, 3));
        
        const trailMaterial = new THREE.LineBasicMaterial({
            color: 0x0088ff,
            transparent: true,
            opacity: 0.7
        });
        
        const trail = new THREE.Line(trailGeometry, trailMaterial);
        scene.add(trail);
        
        // –ú–∞—Å—Å–∏–≤—ã –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤
        let asteroids = [];
        let enemyShips = [];
        let starFields = [];
        let blackHoles = [];
        let spaceStations = [];
        
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let gameState = {
            health: 100,
            energy: 100,
            stars: 0,
            fragments: 0,
            score: 0,
            speed: 0,
            maxSpeed: 0.5,
            acceleration: 0.01,
            rotationSpeed: 0.05,
            upgrades: {
                engine: 1,
                shield: 1,
                weapon: 1,
                scanner: 1
            },
            leaderboard: JSON.parse(localStorage.getItem('fallingStarsLeaderboard')) || [],
            isShieldActive: false,
            shieldEnergy: 100,
            gameActive: false,
            keys: {},
            mouseX: 0,
            mouseY: 0
        };
        
        // –°—Ç–æ–∏–º–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∏–π
        const upgradeCosts = {
            engine: [10, 25, 50, 100, 200],
            shield: [15, 35, 70, 150, 300],
            weapon: [20, 45, 90, 180, 360],
            scanner: [25, 55, 110, 220, 440]
        };
        
        // –ü—Ä–æ—Ü–µ–¥—É—Ä–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∞—Å—Ç–µ—Ä–æ–∏–¥–æ–≤
        function generateAsteroids(count) {
            for (let i = 0; i < count; i++) {
                const size = Math.random() * 5 + 1;
                const geometry = new THREE.IcosahedronGeometry(size, 0);
                const material = new THREE.MeshPhongMaterial({
                    color: 0x888888,
                    shininess: 30,
                    emissive: 0x222222
                });
                
                const asteroid = new THREE.Mesh(geometry, material);
                
                // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º –∞—Å—Ç–µ—Ä–æ–∏–¥ –≤–ø–µ—Ä–µ–¥–∏ –∏–≥—Ä–æ–∫–∞
                asteroid.position.x = (Math.random() - 0.5) * 200;
                asteroid.position.y = (Math.random() - 0.5) * 200;
                asteroid.position.z = ship.position.z - 100 - Math.random() * 500;
                
                // –°–ª—É—á–∞–π–Ω–æ–µ –≤—Ä–∞—â–µ–Ω–∏–µ
                asteroid.rotation.x = Math.random() * Math.PI;
                asteroid.rotation.y = Math.random() * Math.PI;
                
                // –°–ª—É—á–∞–π–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –≤—Ä–∞—â–µ–Ω–∏—è
                asteroid.userData = {
                    rotationSpeed: {
                        x: (Math.random() - 0.5) * 0.02,
                        y: (Math.random() - 0.5) * 0.02,
                        z: (Math.random() - 0.5) * 0.02
                    },
                    speed: Math.random() * 0.5 + 0.1
                };
                
                asteroid.castShadow = true;
                scene.add(asteroid);
                asteroids.push(asteroid);
            }
        }
        
        // –ü—Ä–æ—Ü–µ–¥—É—Ä–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—Ä–∞–∂–µ—Å–∫–∏—Ö –∫–æ—Ä–∞–±–ª–µ–π
        function generateEnemyShips(count) {
            for (let i = 0; i < count; i++) {
                const geometry = new THREE.OctahedronGeometry(3, 0);
                const material = new THREE.MeshPhongMaterial({
                    color: 0xff3300,
                    shininess: 100,
                    emissive: 0x330000
                });
                
                const enemyShip = new THREE.Mesh(geometry, material);
                
                // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º –≤—Ä–∞–∂–µ—Å–∫–∏–π –∫–æ—Ä–∞–±–ª—å
                enemyShip.position.x = (Math.random() - 0.5) * 150;
                enemyShip.position.y = (Math.random() - 0.5) * 150;
                enemyShip.position.z = ship.position.z - 200 - Math.random() * 400;
                
                enemyShip.userData = {
                    speed: Math.random() * 0.3 + 0.2,
                    health: 30,
                    fireRate: 1000 + Math.random() * 2000,
                    lastShot: 0
                };
                
                enemyShip.castShadow = true;
                scene.add(enemyShip);
                enemyShips.push(enemyShip);
            }
        }
        
        // –ü—Ä–æ—Ü–µ–¥—É—Ä–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–ª–µ–π –∑–≤—ë–∑–¥ (—Ä–µ—Å—É—Ä—Å—ã)
        function generateStarFields(count) {
            for (let i = 0; i < count; i++) {
                const geometry = new THREE.SphereGeometry(2, 8, 8);
                const material = new THREE.MeshPhongMaterial({
                    color: 0xffff00,
                    shininess: 100,
                    emissive: 0x444400
                });
                
                const starField = new THREE.Mesh(geometry, material);
                
                // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º –ø–æ–ª–µ –∑–≤—ë–∑–¥
                starField.position.x = (Math.random() - 0.5) * 180;
                starField.position.y = (Math.random() - 0.5) * 180;
                starField.position.z = ship.position.z - 150 - Math.random() * 450;
                
                starField.userData = {
                    rotationSpeed: (Math.random() - 0.5) * 0.05,
                    collected: false
                };
                
                starField.castShadow = true;
                scene.add(starField);
                starFields.push(starField);
            }
        }
        
        // –ü—Ä–æ—Ü–µ–¥—É—Ä–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —á—ë—Ä–Ω—ã—Ö –¥—ã—Ä
        function generateBlackHoles(count) {
            for (let i = 0; i < count; i++) {
                const geometry = new THREE.SphereGeometry(8, 32, 32);
                const material = new THREE.MeshPhongMaterial({
                    color: 0x000000,
                    shininess: 100,
                    emissive: 0x220022
                });
                
                const blackHole = new THREE.Mesh(geometry, material);
                
                // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º —á—ë—Ä–Ω—É—é –¥—ã—Ä—É
                blackHole.position.x = (Math.random() - 0.5) * 100;
                blackHole.position.y = (Math.random() - 0.5) * 100;
                blackHole.position.z = ship.position.z - 250 - Math.random() * 300;
                
                // –ì—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω–æ–µ –ø–æ–ª–µ
                const gravityField = new THREE.Mesh(
                    new THREE.SphereGeometry(30, 16, 16),
                    new THREE.MeshBasicMaterial({
                        color: 0x440044,
                        transparent: true,
                        opacity: 0.1,
                        wireframe: true
                    })
                );
                
                blackHole.add(gravityField);
                blackHole.userData = {
                    gravityStrength: 0.05
                };
                
                blackHole.castShadow = true;
                scene.add(blackHole);
                blackHoles.push(blackHole);
            }
        }
        
        // –ü—Ä–æ—Ü–µ–¥—É—Ä–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ—Å–º–∏—á–µ—Å–∫–∏—Ö —Å—Ç–∞–Ω—Ü–∏–π
        function generateSpaceStations(count) {
            for (let i = 0; i < count; i++) {
                const group = new THREE.Group();
                
                // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å
                const centerGeometry = new THREE.CylinderGeometry(5, 5, 10, 8);
                const centerMaterial = new THREE.MeshPhongMaterial({
                    color: 0x4444ff,
                    shininess: 80,
                    emissive: 0x111133
                });
                
                const center = new THREE.Mesh(centerGeometry, centerMaterial);
                group.add(center);
                
                // –ö–æ–ª—å—Ü–∞
                const ringGeometry = new THREE.TorusGeometry(8, 1, 8, 20);
                const ringMaterial = new THREE.MeshPhongMaterial({
                    color: 0x8888ff,
                    shininess: 80,
                    emissive: 0x222244
                });
                
                const ring1 = new THREE.Mesh(ringGeometry, ringMaterial);
                ring1.rotation.x = Math.PI / 2;
                group.add(ring1);
                
                const ring2 = new THREE.Mesh(ringGeometry, ringMaterial);
                ring2.rotation.y = Math.PI / 2;
                group.add(ring2);
                
                // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º —Å—Ç–∞–Ω—Ü–∏—é
                group.position.x = (Math.random() - 0.5) * 120;
                group.position.y = (Math.random() - 0.5) * 120;
                group.position.z = ship.position.z - 300 - Math.random() * 400;
                
                group.userData = {
                    rotationSpeed: 0.005,
                    health: 100
                };
                
                group.castShadow = true;
                scene.add(group);
                spaceStations.push(group);
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π —Ç—Ä–∞—Å—Å–∏—Ä—É—é—â–µ–π –ª–∏–Ω–∏–∏
        function updateTrail() {
            const positions = trail.geometry.attributes.position.array;
            
            // –°–¥–≤–∏–≥–∞–µ–º –≤—Å–µ —Ç–æ—á–∫–∏ –Ω–∞–∑–∞–¥
            for (let i = positions.length - 1; i >= 3; i--) {
                positions[i] = positions[i - 3];
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é —Ç–æ—á–∫—É –≤ –Ω–∞—á–∞–ª–æ
            positions[0] = ship.position.x;
            positions[1] = ship.position.y;
            positions[2] = ship.position.z + 5;
            
            trail.geometry.attributes.position.needsUpdate = true;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
        function updateGameState() {
            if (!gameState.gameActive) return;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É–ª—É—á—à–µ–Ω–∏–π –¥–≤–∏–≥–∞—Ç–µ–ª—è
            gameState.maxSpeed = 0.5 + (gameState.upgrades.engine - 1) * 0.2;
            
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–∞–±–ª–µ–º
            if (gameState.keys['ArrowUp'] || gameState.keys['w']) {
                gameState.speed = Math.min(gameState.speed + gameState.acceleration, gameState.maxSpeed);
            } else if (gameState.keys['ArrowDown'] || gameState.keys['s']) {
                gameState.speed = Math.max(gameState.speed - gameState.acceleration * 2, 0);
            } else {
                // –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –∑–∞–º–µ–¥–ª–µ–Ω–∏–µ
                gameState.speed = Math.max(gameState.speed - gameState.acceleration * 0.5, 0);
            }
            
            // –ü–æ–≤–æ—Ä–æ—Ç –∫–æ—Ä–∞–±–ª—è
            if (gameState.keys['ArrowLeft'] || gameState.keys['a']) {
                ship.rotation.z += gameState.rotationSpeed;
            }
            if (gameState.keys['ArrowRight'] || gameState.keys['d']) {
                ship.rotation.z -= gameState.rotationSpeed;
            }
            
            // –î–≤–∏–∂–µ–Ω–∏–µ –∫–æ—Ä–∞–±–ª—è –≤–ø–µ—Ä–µ–¥
            ship.position.x -= Math.sin(ship.rotation.z) * gameState.speed;
            ship.position.y += Math.cos(ship.rotation.z) * gameState.speed;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –∫–∞–º–µ—Ä—ã
            camera.position.x = ship.position.x;
            camera.position.y = ship.position.y;
            camera.position.z = ship.position.z + 20;
            camera.lookAt(ship.position.x, ship.position.y, ship.position.z - 10);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞—Å—Å–∏—Ä—É—é—â–µ–π –ª–∏–Ω–∏–∏
            updateTrail();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞—Å—Ç–µ—Ä–æ–∏–¥–æ–≤
            asteroids.forEach((asteroid, index) => {
                asteroid.position.z += asteroid.userData.speed;
                asteroid.rotation.x += asteroid.userData.rotationSpeed.x;
                asteroid.rotation.y += asteroid.userData.rotationSpeed.y;
                asteroid.rotation.z += asteroid.userData.rotationSpeed.z;
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –∫–æ—Ä–∞–±–ª–µ–º
                const distance = Math.sqrt(
                    Math.pow(asteroid.position.x - ship.position.x, 2) +
                    Math.pow(asteroid.position.y - ship.position.y, 2) +
                    Math.pow(asteroid.position.z - ship.position.z, 2)
                );
                
                if (distance < 10) {
                    if (gameState.isShieldActive) {
                        // –©–∏—Ç –ø–æ–≥–ª–æ—â–∞–µ—Ç —É—Ä–æ–Ω
                        gameState.shieldEnergy -= 20;
                        if (gameState.shieldEnergy <= 0) {
                            gameState.isShieldActive = false;
                            gameState.shieldEnergy = 0;
                        }
                    } else {
                        gameState.health -= 10;
                    }
                    
                    // –£–¥–∞–ª—è–µ–º –∞—Å—Ç–µ—Ä–æ–∏–¥ –ø–æ—Å–ª–µ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
                    scene.remove(asteroid);
                    asteroids.splice(index, 1);
                    
                    // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –∞—Å—Ç–µ—Ä–æ–∏–¥
                    generateAsteroids(1);
                }
                
                // –ï—Å–ª–∏ –∞—Å—Ç–µ—Ä–æ–∏–¥ —É—à–µ–ª –¥–∞–ª–µ–∫–æ –Ω–∞–∑–∞–¥, —É–¥–∞–ª—è–µ–º –µ–≥–æ –∏ —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –≤–ø–µ—Ä–µ–¥–∏
                if (asteroid.position.z > ship.position.z + 50) {
                    scene.remove(asteroid);
                    asteroids.splice(index, 1);
                    generateAsteroids(1);
                }
            });
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–∞–∂–µ—Å–∫–∏—Ö –∫–æ—Ä–∞–±–ª–µ–π
            enemyShips.forEach((enemy, index) => {
                enemy.position.z += enemy.userData.speed;
                
                // –ü—Ä–æ—Å—Ç–æ–µ –ø—Ä–µ—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
                if (enemy.position.x < ship.position.x) {
                    enemy.position.x += 0.1;
                } else {
                    enemy.position.x -= 0.1;
                }
                
                if (enemy.position.y < ship.position.y) {
                    enemy.position.y += 0.1;
                } else {
                    enemy.position.y -= 0.1;
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –∫–æ—Ä–∞–±–ª–µ–º
                const distance = Math.sqrt(
                    Math.pow(enemy.position.x - ship.position.x, 2) +
                    Math.pow(enemy.position.y - ship.position.y, 2) +
                    Math.pow(enemy.position.z - ship.position.z, 2)
                );
                
                if (distance < 8) {
                    if (gameState.isShieldActive) {
                        gameState.shieldEnergy -= 15;
                        if (gameState.shieldEnergy <= 0) {
                            gameState.isShieldActive = false;
                            gameState.shieldEnergy = 0;
                        }
                    } else {
                        gameState.health -= 15;
                    }
                    
                    // –£–¥–∞–ª—è–µ–º –≤—Ä–∞–∂–µ—Å–∫–∏–π –∫–æ—Ä–∞–±–ª—å
                    scene.remove(enemy);
                    enemyShips.splice(index, 1);
                    gameState.fragments += 5;
                    
                    // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–≥–æ –≤—Ä–∞–≥–∞
                    generateEnemyShips(1);
                }
                
                // –ï—Å–ª–∏ –≤—Ä–∞–≥ —É—à–µ–ª –¥–∞–ª–µ–∫–æ –Ω–∞–∑–∞–¥, —É–¥–∞–ª—è–µ–º –µ–≥–æ –∏ —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–≥–æ –≤–ø–µ—Ä–µ–¥–∏
                if (enemy.position.z > ship.position.z + 50) {
                    scene.remove(enemy);
                    enemyShips.splice(index, 1);
                    generateEnemyShips(1);
                }
            });
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π –∑–≤—ë–∑–¥
            starFields.forEach((star, index) => {
                star.rotation.y += star.userData.rotationSpeed;
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–±–æ—Ä–∞
                const distance = Math.sqrt(
                    Math.pow(star.position.x - ship.position.x, 2) +
                    Math.pow(star.position.y - ship.position.y, 2) +
                    Math.pow(star.position.z - ship.position.z, 2)
                );
                
                if (distance < 7 && !star.userData.collected) {
                    star.userData.collected = true;
                    gameState.stars += 1;
                    gameState.score += 10;
                    
                    // –ê–Ω–∏–º–∞—Ü–∏—è —Å–±–æ—Ä–∞
                    star.scale.set(0.1, 0.1, 0.1);
                    
                    // –£–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è
                    setTimeout(() => {
                        scene.remove(star);
                        starFields.splice(index, 1);
                        generateStarFields(1);
                    }, 300);
                }
                
                // –ï—Å–ª–∏ –∑–≤–µ–∑–¥–∞ —É—à–ª–∞ –¥–∞–ª–µ–∫–æ –Ω–∞–∑–∞–¥, —É–¥–∞–ª—è–µ–º –µ—ë –∏ —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –≤–ø–µ—Ä–µ–¥–∏
                if (star.position.z > ship.position.z + 50) {
                    scene.remove(star);
                    starFields.splice(index, 1);
                    generateStarFields(1);
                }
            });
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á—ë—Ä–Ω—ã—Ö –¥—ã—Ä
            blackHoles.forEach((blackHole, index) => {
                // –ì—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω–æ–µ –ø—Ä–∏—Ç—è–∂–µ–Ω–∏–µ
                const dx = blackHole.position.x - ship.position.x;
                const dy = blackHole.position.y - ship.position.y;
                const dz = blackHole.position.z - ship.position.z;
                
                const distance = Math.sqrt(dx * dx + dy * dy + dz * dz);
                
                if (distance < 30) {
                    const force = blackHole.userData.gravityStrength / (distance * distance);
                    ship.position.x += dx * force;
                    ship.position.y += dy * force;
                    ship.position.z += dz * force;
                    
                    // –ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –æ—Ç –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–∏
                    if (distance < 15) {
                        gameState.health -= 0.5;
                    }
                }
                
                // –ï—Å–ª–∏ —á—ë—Ä–Ω–∞—è –¥—ã—Ä–∞ —É—à–ª–∞ –¥–∞–ª–µ–∫–æ –Ω–∞–∑–∞–¥, —É–¥–∞–ª—è–µ–º –µ—ë –∏ —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –≤–ø–µ—Ä–µ–¥–∏
                if (blackHole.position.z > ship.position.z + 50) {
                    scene.remove(blackHole);
                    blackHoles.splice(index, 1);
                    generateBlackHoles(1);
                }
            });
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ—Å–º–∏—á–µ—Å–∫–∏—Ö —Å—Ç–∞–Ω—Ü–∏–π
            spaceStations.forEach((station, index) => {
                station.rotation.y += station.userData.rotationSpeed;
                
                // –ï—Å–ª–∏ —Å—Ç–∞–Ω—Ü–∏—è —É—à–ª–∞ –¥–∞–ª–µ–∫–æ –Ω–∞–∑–∞–¥, —É–¥–∞–ª—è–µ–º –µ—ë –∏ —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –≤–ø–µ—Ä–µ–¥–∏
                if (station.position.z > ship.position.z + 50) {
                    scene.remove(station);
                    spaceStations.splice(index, 1);
                    generateSpaceStations(1);
                }
            });
            
            // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ —â–∏—Ç–∞
            if (!gameState.isShieldActive && gameState.shieldEnergy < 100) {
                gameState.shieldEnergy = Math.min(gameState.shieldEnergy + 0.1, 100);
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            updateUI();
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã
            if (gameState.health <= 0) {
                gameOver();
            }
            
            // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—á—ë—Ç–∞ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
            gameState.score += gameState.speed * 0.1;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateUI() {
            document.getElementById('healthValue').textContent = Math.max(0, Math.round(gameState.health));
            document.getElementById('energyValue').textContent = Math.round(gameState.energy);
            document.getElementById('speedValue').textContent = Math.round(gameState.speed * 100);
            document.getElementById('starsValue').textContent = gameState.stars;
            document.getElementById('fragmentsValue').textContent = gameState.fragments;
            document.getElementById('scoreValue').textContent = Math.round(gameState.score);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω–µ–π —É–ª—É—á—à–µ–Ω–∏–π
            document.getElementById('engineLevel').textContent = gameState.upgrades.engine;
            document.getElementById('shieldLevel').textContent = gameState.upgrades.shield;
            document.getElementById('weaponLevel').textContent = gameState.upgrades.weapon;
            document.getElementById('scannerLevel').textContent = gameState.upgrades.scanner;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —É–ª—É—á—à–µ–Ω–∏–π
            document.getElementById('engineCost').textContent = upgradeCosts.engine[gameState.upgrades.engine - 1] || 'MAX';
            document.getElementById('shieldCost').textContent = upgradeCosts.shield[gameState.upgrades.shield - 1] || 'MAX';
            document.getElementById('weaponCost').textContent = upgradeCosts.weapon[gameState.upgrades.weapon - 1] || 'MAX';
            document.getElementById('scannerCost').textContent = upgradeCosts.scanner[gameState.upgrades.scanner - 1] || 'MAX';
        }
        
        // –ê–∫—Ç–∏–≤–∞—Ü–∏—è —â–∏—Ç–∞
        function activateShield() {
            if (gameState.shieldEnergy >= 20 && !gameState.isShieldActive) {
                gameState.isShieldActive = true;
                
                // –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç —â–∏—Ç–∞
                const shieldGeometry = new THREE.SphereGeometry(6, 16, 16);
                const shieldMaterial = new THREE.MeshBasicMaterial({
                    color: 0x00ffff,
                    transparent: true,
                    opacity: 0.3,
                    wireframe: true
                });
                
                const shield = new THREE.Mesh(shieldGeometry, shieldMaterial);
                ship.add(shield);
                
                // –£–±–∏—Ä–∞–µ–º —â–∏—Ç —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è
                setTimeout(() => {
                    if (shield.parent) {
                        ship.remove(shield);
                    }
                    gameState.isShieldActive = false;
                }, 3000);
            }
        }
        
        // –ü–æ–∫—É–ø–∫–∞ —É–ª—É—á—à–µ–Ω–∏—è
        function buyUpgrade(type) {
            const currentLevel = gameState.upgrades[type];
            const cost = upgradeCosts[type][currentLevel - 1];
            
            if (cost && gameState.stars >= cost) {
                gameState.stars -= cost;
                gameState.upgrades[type]++;
                updateUI();
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç—ã —É–ª—É—á—à–µ–Ω–∏—è
                if (type === 'engine') {
                    gameState.maxSpeed += 0.2;
                } else if (type === 'shield') {
                    gameState.shieldEnergy = 100;
                }
            }
        }
        
        // –ö–æ–Ω–µ—Ü –∏–≥—Ä—ã
        function gameOver() {
            gameState.gameActive = false;
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ç–∞–±–ª–∏—Ü—É —Ä–µ–∫–æ—Ä–¥–æ–≤
            gameState.leaderboard.push({
                score: Math.round(gameState.score),
                date: new Date().toLocaleDateString()
            });
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é –æ—á–∫–æ–≤
            gameState.leaderboard.sort((a, b) => b.score - a.score);
            
            // –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–æ–ø-10
            if (gameState.leaderboard.length > 10) {
                gameState.leaderboard = gameState.leaderboard.slice(0, 10);
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            localStorage.setItem('fallingStarsLeaderboard', JSON.stringify(gameState.leaderboard));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã
            document.getElementById('finalScore').textContent = Math.round(gameState.score);
            showScreen('gameOverScreen');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É —Ä–µ–∫–æ—Ä–¥–æ–≤
            updateLeaderboard();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Ä–µ–∫–æ—Ä–¥–æ–≤
        function updateLeaderboard() {
            const leaderboardElement = document.getElementById('leaderboard');
            leaderboardElement.innerHTML = '';
            
            gameState.leaderboard.forEach((entry, index) => {
                const item = document.createElement('div');
                item.className = 'leaderboard-item';
                item.innerHTML = `
                    <span>${index + 1}. ${entry.score} –æ—á–∫–æ–≤</span>
                    <span>${entry.date}</span>
                `;
                leaderboardElement.appendChild(item);
            });
            
            if (gameState.leaderboard.length === 0) {
                const emptyMessage = document.createElement('div');
                emptyMessage.className = 'leaderboard-item';
                emptyMessage.textContent = '–ü–æ–∫–∞ –Ω–µ—Ç —Ä–µ–∫–æ—Ä–¥–æ–≤';
                leaderboardElement.appendChild(emptyMessage);
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —ç–∫—Ä–∞–Ω
        function showScreen(screenId) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç–∫—Ä–∞–Ω—ã
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.add('hidden');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π —ç–∫—Ä–∞–Ω
            document.getElementById(screenId).classList.remove('hidden');
        }
        
        // –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã
        function startGame() {
            // –°–±—Ä–æ—Å –∏–≥—Ä–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
            gameState.health = 100;
            gameState.energy = 100;
            gameState.stars = 0;
            gameState.fragments = 0;
            gameState.score = 0;
            gameState.speed = 0;
            gameState.isShieldActive = false;
            gameState.shieldEnergy = 100;
            gameState.gameActive = true;
            
            // –°–±—Ä–æ—Å –ø–æ–∑–∏—Ü–∏–∏ –∫–æ—Ä–∞–±–ª—è
            ship.position.x = 0;
            ship.position.y = 0;
            ship.position.z = 15;
            ship.rotation.z = 0;
            
            // –û—á–∏—Å—Ç–∫–∞ —Å—Ü–µ–Ω—ã –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤
            asteroids.forEach(asteroid => scene.remove(asteroid));
            enemyShips.forEach(enemy => scene.remove(enemy));
            starFields.forEach(star => scene.remove(star));
            blackHoles.forEach(blackHole => scene.remove(blackHole));
            spaceStations.forEach(station => scene.remove(station));
            
            asteroids = [];
            enemyShips = [];
            starFields = [];
            blackHoles = [];
            spaceStations = [];
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞—á–∞–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
            generateAsteroids(20);
            generateEnemyShips(5);
            generateStarFields(10);
            generateBlackHoles(2);
            generateSpaceStations(3);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω
            showScreen('gameScreen');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateUI();
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞
            document.addEventListener('keydown', (e) => {
                gameState.keys[e.key] = true;
                
                // –ê–∫—Ç–∏–≤–∞—Ü–∏—è —â–∏—Ç–∞ –ø—Ä–æ–±–µ–ª–æ–º
                if (e.key === ' ' && gameState.gameActive) {
                    activateShield();
                }
            });
            
            document.addEventListener('keyup', (e) => {
                gameState.keys[e.key] = false;
            });
            
            // –ö–Ω–æ–ø–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            document.getElementById('startBtn').addEventListener('click', startGame);
            document.getElementById('upgradesBtn').addEventListener('click', () => {
                showScreen('upgradesScreen');
                updateUI();
            });
            document.getElementById('recordsBtn').addEventListener('click', () => {
                showScreen('recordsScreen');
                updateLeaderboard();
            });
            document.getElementById('backFromUpgradesBtn').addEventListener('click', () => showScreen('menuScreen'));
            document.getElementById('backFromRecordsBtn').addEventListener('click', () => showScreen('menuScreen'));
            document.getElementById('restartBtn').addEventListener('click', startGame);
            document.getElementById('menuFromGameOverBtn').addEventListener('click', () => showScreen('menuScreen'));
            
            // –ö–Ω–æ–ø–∫–∏ —É–ª—É—á—à–µ–Ω–∏–π
            document.querySelectorAll('.upgrade').forEach(upgrade => {
                upgrade.addEventListener('click', () => {
                    const type = upgrade.getAttribute('data-upgrade');
                    buyUpgrade(type);
                });
            });
            
            // –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ
            document.getElementById('leftBtn').addEventListener('click', () => {
                ship.rotation.z += gameState.rotationSpeed;
            });
            
            document.getElementById('rightBtn').addEventListener('click', () => {
                ship.rotation.z -= gameState.rotationSpeed;
            });
            
            document.getElementById('shieldBtn').addEventListener('click', () => {
                if (gameState.gameActive) {
                    activateShield();
                }
            });
            
            // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—é —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });
        }
        
        // –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
        function gameLoop() {
            updateGameState();
            renderer.render(scene, camera);
            requestAnimationFrame(gameLoop);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function init() {
            setupEventListeners();
            updateLeaderboard();
            gameLoop();
        }
        
        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', init);
    </script>
</body>
</html>