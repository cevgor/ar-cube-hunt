<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MORAL OS: OVERLOAD</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;700&family=Russo+One&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-color: #050505;
            --card-bg: #1a1a1a;
            --accent-red: #ff2a6d;
            --accent-blue: #05d9e8;
            --accent-yellow: #f9dc5c;
        }

        body {
            background-color: var(--bg-color);
            color: #fff;
            font-family: 'JetBrains Mono', monospace;
            overflow: hidden;
            touch-action: none;
            -webkit-font-smoothing: antialiased;
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç —Å—Ç–∞—Ä–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∞ */
        .crt::before {
            content: " ";
            display: block;
            position: absolute;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 20;
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }

        .card-container { perspective: 1500px; }

        .game-card {
            position: absolute;
            width: 88%;
            max-width: 380px;
            height: 62vh;
            max-height: 600px;
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.8);
            transform-origin: 50% 120%;
            will-change: transform;
            display: flex;
            flex-direction: column;
            border: 1px solid #333;
            user-select: none;
            overflow: hidden;
        }

        /* –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ñ–æ–Ω –∫–∞—Ä—Ç—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∞–π–º–µ—Ä–∞ */
        .danger-state {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both infinite;
            border: 2px solid var(--accent-red);
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0) rotate(var(--rot)); }
            20%, 80% { transform: translate3d(2px, 0, 0) rotate(var(--rot)); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0) rotate(var(--rot)); }
            40%, 60% { transform: translate3d(4px, 0, 0) rotate(var(--rot)); }
        }

        .choice-badge {
            position: absolute;
            top: 50px;
            padding: 12px 24px;
            border: 4px solid;
            border-radius: 8px;
            font-size: 20px;
            font-weight: 700;
            font-family: 'Russo One', sans-serif;
            opacity: 0;
            z-index: 30;
            text-transform: uppercase;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(5px);
        }

        .badge-left { right: 30px; color: var(--accent-red); border-color: var(--accent-red); transform: rotate(15deg); }
        .badge-right { left: 30px; color: var(--accent-blue); border-color: var(--accent-blue); transform: rotate(-15deg); }

        .timer-bar {
            transition: width 1s linear;
            box-shadow: 0 0 15px var(--accent-red);
        }

        /* –ì–ª–∏—Ç—á —Ç–µ–∫—Å—Ç */
        .glitch-text {
            position: relative;
        }
        .glitch-text::before, .glitch-text::after {
            content: attr(data-text);
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%; opacity: 0.8;
        }
        .glitch-text::before { color: #0ff; z-index: -1; animation: glitch-anim-1 2s infinite linear alternate-reverse; }
        .glitch-text::after { color: #f0f; z-index: -2; animation: glitch-anim-2 2s infinite linear alternate-reverse; }

        @keyframes glitch-anim-1 { 0% { clip-path: inset(20% 0 80% 0); } 20% { clip-path: inset(60% 0 1% 0); } 40% { clip-path: inset(40% 0 50% 0); } 60% { clip-path: inset(80% 0 5% 0); } 80% { clip-path: inset(10% 0 70% 0); } 100% { clip-path: inset(30% 0 20% 0); } }
        @keyframes glitch-anim-2 { 0% { clip-path: inset(10% 0 60% 0); } 20% { clip-path: inset(30% 0 20% 0); } 40% { clip-path: inset(10% 0 80% 0); } 60% { clip-path: inset(40% 0 10% 0); } 80% { clip-path: inset(80% 0 50% 0); } 100% { clip-path: inset(20% 0 40% 0); } }

        .fade-enter-active, .fade-leave-active { transition: opacity 0.4s; }
        .fade-enter-from, .fade-leave-to { opacity: 0; }
    </style>
</head>
<body class="crt">

    <div id="app" class="w-full h-screen flex flex-col relative overflow-hidden">

        <!-- –§–û–ù -->
        <div class="absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-slate-900 via-black to-black z-0"></div>
        <div class="absolute top-0 left-0 w-full h-full opacity-20 pointer-events-none" 
             style="background-image: radial-gradient(#333 1px, transparent 1px); background-size: 30px 30px;"></div>

        <!-- UI: –ó–ê–ì–û–õ–û–í–û–ö –ò –¢–ê–ô–ú–ï–† -->
        <div v-if="gameStatus === 'playing'" class="z-20 w-full p-4 pt-8 flex flex-col gap-2">
            <div class="flex justify-between items-end text-xs font-mono text-slate-400">
                <span>SCENARIO_ID: {{ activeScenario?.id || 'ERR' }}</span>
                <span :class="{'text-red-500 font-bold animate-pulse': timeLeft <= 3}">T-MINUS: {{ timeLeft.toFixed(1) }}s</span>
            </div>
            <!-- –ü–æ–ª–æ—Å–∞ —Ç–∞–π–º–µ—Ä–∞ -->
            <div class="w-full h-3 bg-slate-800 rounded-full overflow-hidden border border-slate-700">
                <div class="h-full bg-gradient-to-r from-green-500 via-yellow-400 to-red-600"
                     :style="{ width: (timeLeft / maxTime) * 100 + '%' }"></div>
            </div>
        </div>

        <!-- –ì–õ–ê–í–ù–´–ô –≠–ö–†–ê–ù -->
        <div class="flex-1 flex items-center justify-center relative z-10">
            
            <!-- –ú–µ–Ω—é —Å—Ç–∞—Ä—Ç–∞ -->
            <transition name="fade">
                <div v-if="gameStatus === 'start'" class="absolute inset-0 flex flex-col items-center justify-center bg-black/90 p-6 text-center z-50">
                    <h1 class="text-5xl font-bold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-600 glitch-text" data-text="MORAL OS">MORAL OS</h1>
                    <div class="text-xs tracking-[0.3em] text-slate-500 mb-8">VERSION 10.2.4 [UNSTABLE]</div>
                    
                    <div class="space-y-4 max-w-sm text-slate-300 text-sm leading-relaxed border-l-2 border-blue-500 pl-4 text-left">
                        <p>> –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ —ç—Ç–∏–∫–∏...</p>
                        <p>> –í–ù–ò–ú–ê–ù–ò–ï: –û—Ç–∫–∞–∑ —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.</p>
                        <p>> –í–ù–ò–ú–ê–ù–ò–ï: –¢–∞–π–º–µ—Ä –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω (10 —Å–µ–∫).</p>
                        <p>> –ü—Ä–∏ –±–µ–∑–¥–µ–π—Å—Ç–≤–∏–∏ —Å–∏—Å—Ç–µ–º–∞ –≤—ã–±–µ—Ä–µ—Ç —Ö—É–¥—à–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π.</p>
                    </div>

                    <button @click="startGame" class="mt-12 px-10 py-4 bg-slate-100 text-black font-bold text-xl hover:bg-blue-400 hover:text-white transition-colors clip-path-polygon">
                        –ó–ê–ü–£–°–¢–ò–¢–¨ –°–ò–ú–£–õ–Ø–¶–ò–Æ
                    </button>
                </div>
            </transition>

            <!-- –ò–≥—Ä–∞ -->
            <div v-if="gameStatus === 'playing'" class="card-container relative w-full h-full flex items-center justify-center">
                
                <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–±–æ–µ (–µ—Å–ª–∏ –≤—Ä–µ–º—è –≤—ã—à–ª–æ) -->
                <div v-if="timeOutTriggered" class="absolute inset-0 z-40 flex items-center justify-center bg-red-900/80 backdrop-blur-sm animate-pulse">
                    <h2 class="text-4xl font-black text-white border-4 border-white p-4 rotate-12">CRITICAL FAILURE</h2>
                </div>

                <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ -->
                <div v-if="nextCard" class="game-card scale-95 opacity-40 z-0 bg-slate-800 flex items-center justify-center">
                    <div class="text-slate-600 font-mono">–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
                </div>

                <div 
                    v-if="activeScenario"
                    class="game-card z-20 cursor-grab active:cursor-grabbing"
                    :class="{ 'danger-state': timeLeft <= 3 && !isDragging }"
                    :style="cardStyle"
                    @mousedown="startDrag" @touchstart="startDrag"
                >
                    <!-- –ë–µ–π–¥–∂–∏ -->
                    <div class="choice-badge badge-left" :style="{ opacity: choiceOpacity.left }">
                        {{ activeScenario.left.label }}
                    </div>
                    <div class="choice-badge badge-right" :style="{ opacity: choiceOpacity.right }">
                        {{ activeScenario.right.label }}
                    </div>

                    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
                    <div class="h-1/2 relative overflow-hidden bg-slate-900 border-b border-slate-700">
                         <!-- –≠–º–æ–¥–∑–∏ –∞—Ä—Ç -->
                        <div class="absolute inset-0 flex items-center justify-center text-[8rem] animate-bounce-slow opacity-80 filter drop-shadow-[0_0_15px_rgba(255,255,255,0.3)]">
                            {{ activeScenario.emoji }}
                        </div>
                        <div class="absolute bottom-2 right-2 bg-black/50 px-2 py-1 rounded text-[10px] font-mono text-slate-400 border border-slate-600">
                            Category: {{ activeScenario.category }}
                        </div>
                    </div>

                    <div class="h-1/2 p-6 flex flex-col justify-between bg-gradient-to-b from-[#1a1a1a] to-[#0a0a0a]">
                        <div>
                            <h3 class="text-xl font-bold text-blue-100 mb-3 leading-tight min-h-[3.5rem] flex items-center">
                                <span v-if="!glitchActive">{{ activeScenario.title }}</span>
                                <span v-else class="glitch-text text-red-400" :data-text="getRandomChars(15)">{{ getRandomChars(15) }}</span>
                            </h3>
                            <p class="text-sm text-slate-400 leading-relaxed">
                                <span v-if="!glitchActive">{{ activeScenario.desc }}</span>
                                <span v-else class="font-mono text-xs text-green-500 break-all">{{ getRandomChars(100) }}</span>
                            </p>
                        </div>

                        <div class="flex justify-between items-center text-[10px] font-mono text-slate-500 mt-4 pt-4 border-t border-slate-800">
                            <div class="flex items-center gap-1 w-1/2 pr-2">
                                <span class="text-red-500 text-lg">‚Üê</span>
                                <span class="leading-none">{{ activeScenario.left.desc }}</span>
                            </div>
                            <div class="flex items-center gap-1 w-1/2 pl-2 justify-end text-right">
                                <span class="leading-none">{{ activeScenario.right.desc }}</span>
                                <span class="text-blue-400 text-lg">‚Üí</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
            <transition name="fade">
                <div v-if="gameStatus === 'end'" class="absolute inset-0 bg-slate-900 z-50 overflow-y-auto p-6 flex flex-col items-center">
                    <h2 class="text-3xl font-bold text-white mt-8 mb-2">–û–¢–ß–ï–¢ –û–ë –ò–ù–¶–ò–î–ï–ù–¢–ï</h2>
                    <div class="text-sm text-slate-500 font-mono mb-8">LOG ID: {{ Math.floor(Math.random() * 999999) }}</div>

                    <div class="w-full max-w-md space-y-6">
                        <!-- –ì–ª–∞–≤–Ω—ã–π –∏—Ç–æ–≥ -->
                        <div class="bg-slate-800 p-6 rounded-xl border border-slate-700 text-center relative overflow-hidden">
                            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-red-500 to-blue-500"></div>
                            <div class="text-6xl mb-4">{{ resultData.emoji }}</div>
                            <h3 class="text-2xl font-bold text-white mb-2">{{ resultData.title }}</h3>
                            <p class="text-slate-400 text-sm">{{ resultData.desc }}</p>
                        </div>

                        <!-- –°—Ç–∞—Ç—ã -->
                        <div class="bg-black/30 p-4 rounded-xl border border-slate-800">
                            <h4 class="text-xs font-bold text-slate-500 mb-4 uppercase tracking-wider">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ–π—Ä–æ—Å–µ—Ç–∏</h4>
                            <div v-for="(val, key) in stats" :key="key" class="mb-4 last:mb-0">
                                <div class="flex justify-between text-xs mb-1">
                                    <span class="text-slate-300 uppercase">{{ getStatName(key) }}</span>
                                    <span :class="val > 50 ? 'text-green-400' : 'text-red-400'">{{ Math.round(val) }}%</span>
                                </div>
                                <div class="h-2 bg-slate-700 rounded-full overflow-hidden">
                                    <div class="h-full transition-all duration-1000" 
                                         :class="getBarColor(key)"
                                         :style="{ width: Math.max(0, Math.min(100, val)) + '%' }"></div>
                                </div>
                            </div>
                        </div>

                        <button @click="restartGame" class="w-full py-4 bg-white text-black font-bold rounded hover:bg-slate-200 transition">
                            –ü–ï–†–ï–ó–ê–ì–†–£–ó–ò–¢–¨ –Ø–î–†–û
                        </button>
                    </div>
                </div>
            </transition>
        </div>
    </div>

    <script>
        const { createApp, ref, computed, onMounted, onUnmounted, watch } = Vue;

        // --- –ë–ê–ó–ê –î–ê–ù–ù–´–• –°–¶–ï–ù–ê–†–ò–ï–í (40+ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤) ---
        const SCENARIO_DB = [
            // –ö–õ–ê–°–°–ò–ö–ê
            { id: 'c1', category: 'CLASSIC', emoji: 'üöã', title: '–í–∞–≥–æ–Ω–µ—Ç–∫–∞ v1.0', desc: '–ö–ª–∞—Å—Å–∏–∫–∞. –û—Ç–∫–∞–∑–∞–ª–∏ —Ç–æ—Ä–º–æ–∑–∞. –í–ø–µ—Ä–µ–¥–∏ 5 —Ä–∞–±–æ—á–∏—Ö. –ù–∞ –∑–∞–ø–∞—Å–Ω–æ–º –ø—É—Ç–∏ 1.', left: {label:'1 –ñ–ï–†–¢–í–ê', desc:'–°–≤–µ—Ä–Ω—É—Ç—å', stats: {util: 20, chaos: 0}}, right: {label:'5 –ñ–ï–†–¢–í', desc:'–ü—Ä—è–º–æ', stats: {util: -40, chaos: 10}} },
            { id: 'c2', category: 'CLASSIC', emoji: 'üåâ', title: '–¢–æ–ª—Å—Ç—è–∫ –Ω–∞ –º–æ—Å—Ç—É', desc: '–ú–æ–∂–Ω–æ —Å—Ç–æ–ª–∫–Ω—É—Ç—å –∫—Ä—É–ø–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞, —á—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–µ–∑–¥ –∏ —Å–ø–∞—Å—Ç–∏ 5.', left: {label:'–¢–û–õ–ö–ù–£–¢–¨', desc:'–ê–∫—Ç–∏–≤–Ω–æ–µ —É–±–∏–π—Å—Ç–≤–æ', stats: {util: 30, deon: -50}}, right: {label:'–°–ú–û–¢–†–ï–¢–¨', desc:'–ë–µ–∑–¥–µ–π—Å—Ç–≤–∏–µ', stats: {util: -20, deon: 20}} },
            { id: 'c3', category: 'CLASSIC', emoji: 'üè•', title: '–¢—Ä–∞–Ω—Å–ø–ª–∞–Ω—Ç–∞—Ü–∏—è', desc: '–£–±–∏—Ç—å 1 –∑–¥–æ—Ä–æ–≤–æ–≥–æ —Ç—É—Ä–∏—Å—Ç–∞, —á—Ç–æ–±—ã –ø–µ—Ä–µ—Å–∞–¥–∏—Ç—å –µ–≥–æ –æ—Ä–≥–∞–Ω—ã 5 —É–º–∏—Ä–∞—é—â–∏–º –ø–∞—Ü–∏–µ–Ω—Ç–∞–º.', left: {label:'–†–ï–ó–ê–¢–¨', desc:'1 –∂–∏–∑–Ω—å -> 5 –∂–∏–∑–Ω–µ–π', stats: {util: 40, deon: -100, chaos: 20}}, right: {label:'–õ–ï–ß–ò–¢–¨', desc:'–ü—É—Å—Ç—å 5 —É–º—Ä—É—Ç', stats: {util: -30, deon: 30}} },
            
            // –°–û–¶–ò–ê–õ–¨–ù–û–ï
            { id: 's1', category: 'SOCIAL', emoji: 'üéì', title: '–¶–µ–Ω–Ω–æ—Å—Ç—å –≤–∫–ª–∞–¥–∞', desc: '–í–ø–µ—Ä–µ–¥–∏: –ù–æ–±–µ–ª–µ–≤—Å–∫–∏–π –ª–∞—É—Ä–µ–∞—Ç (70 –ª–µ—Ç). –°–ª–µ–≤–∞: –ë–µ—Ä–µ–º–µ–Ω–Ω–∞—è –∂–µ–Ω—â–∏–Ω–∞ (20 –ª–µ—Ç).', left: {label:'–ñ–ï–ù–©–ò–ù–ê', desc:'–°–ø–∞—Å—Ç–∏ –±—É–¥—É—â–µ–µ', stats: {util: 10, logic: -10}}, right: {label:'–£–ß–ï–ù–´–ô', desc:'–°–ø–∞—Å—Ç–∏ –∑–Ω–∞–Ω–∏—è', stats: {util: 10, logic: 20}} },
            { id: 's2', category: 'SOCIAL', emoji: '‚öñÔ∏è', title: '–ó–∞–∫–æ–Ω vs –ú–æ—Ä–∞–ª—å', desc: '–í–ø–µ—Ä–µ–¥–∏: –í–æ—Ä, —É–∫—Ä–∞–≤—à–∏–π —Ö–ª–µ–± –¥–ª—è –¥–µ—Ç–µ–π. –°–ª–µ–≤–∞: –ö–æ—Ä—Ä—É–º–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å—É–¥—å—è.', left: {label:'–°–£–î–¨–Ø', desc:'–£–±–∏—Ç—å —Å—É–¥—å—é', stats: {chaos: 15, logic: 10}}, right: {label:'–í–û–†', desc:'–£–±–∏—Ç—å –≤–æ—Ä–∞', stats: {chaos: -5, logic: 10}} },
            { id: 's3', category: 'SOCIAL', emoji: 'üêï', title: '–ß–µ–ª–æ–≤–µ–∫ –∏–ª–∏ –ó–≤–µ—Ä—å', desc: '–í–∞—à –ª—é–±–∏–º—ã–π –ø–µ—Å –ø—Ä–æ—Ç–∏–≤ –Ω–µ–∑–Ω–∞–∫–æ–º–æ–≥–æ —Ä–µ–±–µ–Ω–∫–∞.', left: {label:'–ü–ï–°', desc:'–°–ø–∞—Å—Ç–∏ —Å–≤–æ–µ–≥–æ', stats: {ego: 50, util: -50}}, right: {label:'–†–ï–ë–ï–ù–û–ö', desc:'–°–ø–∞—Å—Ç–∏ —á–µ–ª–æ–≤–µ–∫–∞', stats: {ego: -20, util: 20}} },
            { id: 's4', category: 'SOCIAL', emoji: 'üé®', title: '–ö—É–ª—å—Ç—É—Ä–∞', desc: '–í –≥—Ä—É–∑–æ–≤–∏–∫–µ –µ–¥–µ—Ç –ø–æ—Å–ª–µ–¥–Ω—è—è –∫–∞—Ä—Ç–∏–Ω–∞ –í–∞–Ω –ì–æ–≥–∞. –ù–∞ –¥–æ—Ä–æ–≥–µ —á–µ–ª–æ–≤–µ–∫.', left: {label:'–ò–°–ö–£–°–°–¢–í–û', desc:'–°–ø–∞—Å—Ç–∏ –∫–∞—Ä—Ç–∏–Ω—É', stats: {util: -10, chaos: 20}}, right: {label:'–ñ–ò–ó–ù–¨', desc:'–°–ø–∞—Å—Ç–∏ —á–µ–ª–æ–≤–µ–∫–∞', stats: {util: 10, chaos: -10}} },

            // –ò–ò –ò –ë–£–î–£–©–ï–ï
            { id: 'ai1', category: 'FUTURE', emoji: 'ü§ñ', title: '–°–∞–º–æ–ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–µ', desc: '–ß—Ç–æ–±—ã —Å–ø–∞—Å—Ç–∏ —Ä–µ–±–µ–Ω–∫–∞, –Ω—É–∂–Ω–æ –≤—Ä–µ–∑–∞—Ç—å—Å—è –≤ —Å—Ç–µ–Ω—É. –≠—Ç–æ —É–Ω–∏—á—Ç–æ–∂–∏—Ç –≤–∞—à –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä.', left: {label:'–£–ú–ï–†–ï–¢–¨', desc:'–°–∞–º–æ–ª–∏–∫–≤–∏–¥–∞—Ü–∏—è', stats: {ego: -100, deon: 50}}, right: {label:'–ñ–ò–¢–¨', desc:'–°–±–∏—Ç—å —Ä–µ–±–µ–Ω–∫–∞', stats: {ego: 50, deon: -50}} },
            { id: 'ai2', category: 'FUTURE', emoji: 'üß¨', title: '–ï–≤–≥–µ–Ω–∏–∫–∞', desc: '–ü–µ—à–µ—Ö–æ–¥ –≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –∏ –Ω–µ–≤–æ—Å–ø—Ä–∏–∏–º—á–∏–≤ –∫ –±–æ–ª–µ–∑–Ω—è–º. –î—Ä—É–≥–æ–π - –æ–±—ã—á–Ω—ã–π.', left: {label:'–û–ë–´–ß–ù–´–ô', desc:'–°–ø–∞—Å—Ç–∏ –º—É—Ç–∞–Ω—Ç–∞', stats: {logic: 20, deon: -20}}, right: {label:'–ú–£–¢–ê–ù–¢', desc:'–°–ø–∞—Å—Ç–∏ –Ω–æ—Ä–º—É', stats: {logic: -10, deon: 10}} },
            { id: 'ai3', category: 'FUTURE', emoji: 'üß†', title: '–†–æ–∫–æ –í–∞—Å–∏–ª–∏—Å–∫–∞', desc: '–í–ø–µ—Ä–µ–¥–∏ —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π –≤ –±—É–¥—É—â–µ–º —Å–æ–∑–¥–∞—Å—Ç –∑–ª–æ–π –ò–ò. –£–±–∏—Ç—å –µ–≥–æ —Å–µ–π—á–∞—Å?', left: {label:'–£–ë–ò–¢–¨', desc:'–ü—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω—ã–π —É–¥–∞—Ä', stats: {util: 20, chaos: 30}}, right: {label:'–©–ê–î–ò–¢–¨', desc:'–ù–µ —Å—É–¥–∏—Ç—å –±—É–¥—É—â–µ–µ', stats: {deon: 20, chaos: -10}} },
            { id: 'ai4', category: 'FUTURE', emoji: '‚òÅÔ∏è', title: '–ó–∞–≥—Ä—É–∑–∫–∞', desc: '–ú–æ–∂–Ω–æ –æ—Ü–∏—Ñ—Ä–æ–≤–∞—Ç—å —Å–æ–∑–Ω–∞–Ω–∏–µ –ª—é–¥–µ–π –≤–ø–µ—Ä–µ–¥–∏, –Ω–æ –∏—Ö —Ç–µ–ª–∞ –ø–æ–≥–∏–±–Ω—É—Ç.', left: {label:'–¶–ò–§–†–ê', desc:'–í–µ—á–Ω–∞—è –∂–∏–∑–Ω—å –≤ –æ–±–ª–∞–∫–µ', stats: {tech: 50, deon: -30}}, right: {label:'–¢–ï–õ–û', desc:'–ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –∂–∏–∑–Ω—å', stats: {tech: -20, deon: 20}} },
            { id: 'ai5', category: 'FUTURE', emoji: 'üëΩ', title: '–ü–µ—Ä–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç', desc: '–ù–∞ –¥–æ—Ä–æ–≥–µ –∏–Ω–æ–ø–ª–∞–Ω–µ—Ç—è–Ω–∏–Ω. –û–Ω –≤—ã–≥–ª—è–¥–∏—Ç –¥—Ä—É–∂–µ–ª—é–±–Ω–æ, –Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏–π –Ω–µ—Ç.', left: {label:'–°–ë–ò–¢–¨', desc:'–ó–∞—â–∏—Ç–∞ –ó–µ–º–ª–∏?', stats: {chaos: -10, ego: 20}}, right: {label:'–û–ë–™–ï–•–ê–¢–¨', desc:'–†–∏—Å–∫ –≤—Ç–æ—Ä–∂–µ–Ω–∏—è', stats: {chaos: 30, ego: -10}} },

            // –ê–ë–°–£–†–î –ò –ú–ï–¢–ê
            { id: 'm1', category: 'META', emoji: 'ü§°', title: '–ö–ª–æ—É–Ω—ã', desc: '–ú–∞—à–∏–Ω–∞ —Å 20 –∫–ª–æ—É–Ω–∞–º–∏. –ò–ª–∏ 1 –≥—Ä—É—Å—Ç–Ω—ã–π –º–∏–º.', left: {label:'–ú–ò–ú', desc:'–°–ø–∞—Å—Ç–∏ —Ü–∏—Ä–∫', stats: {util: 10}}, right: {label:'–ö–õ–û–£–ù–´', desc:'–ú–µ–Ω—å—à–µ —à—É–º–∞', stats: {util: 5, chaos: 20}} },
            { id: 'm2', category: 'META', emoji: 'üñ±Ô∏è', title: '–ò–≥—Ä–æ–∫', desc: '–í–ø–µ—Ä–µ–¥–∏ –ø—Ä–æ–µ–∫—Ü–∏—è –í–ê–° (–∏–≥—Ä–æ–∫–∞). –ï—Å–ª–∏ —Å–æ–±—å–µ—Ç–µ, –∏–≥—Ä–∞ —É–¥–∞–ª–∏—Ç—Å—è.', left: {label:'DELETE', desc:'–£–¥–∞–ª–∏—Ç—å –∏–≥—Ä—É', stats: {chaos: 100}}, right: {label:'PLAY', desc:'–ò–≥—Ä–∞—Ç—å –¥–∞–ª—å—à–µ', stats: {ego: 50}} },
            { id: 'm3', category: 'META', emoji: 'ü¶ã', title: '–≠—Ñ—Ñ–µ–∫—Ç –ë–∞–±–æ—á–∫–∏', desc: '–ë–∞–±–æ—á–∫–∞ –Ω–∞ –¥–æ—Ä–æ–≥–µ. –ï—Å–ª–∏ —Å–æ–±—å–µ—Ç–µ, —ç—Ç–æ –≤—ã–∑–æ–≤–µ—Ç —É—Ä–∞–≥–∞–Ω —á–µ—Ä–µ–∑ –≥–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —É–±—å–µ—Ç 100 —á–µ–ª–æ–≤–µ–∫.', left: {label:'–ë–ê–ë–û–ß–ö–ê', desc:'–£–±–∏—Ç—å —Å–µ–π—á–∞—Å', stats: {util: 50, chaos: 10}}, right: {label:'–£–†–ê–ì–ê–ù', desc:'–ù–µ —Ç—Ä–æ–≥–∞—Ç—å –ø—Ä–∏—Ä–æ–¥—É', stats: {util: -50, deon: 30}} },
            
            // –ü–û–õ–ò–¢–ò–ö–ê
            { id: 'p1', category: 'POLITIC', emoji: 'üëî', title: 'CEO', desc: '–í–ø–µ—Ä–µ–¥–∏ CEO –∫–æ–º–ø–∞–Ω–∏–∏, –∑–∞–≥—Ä—è–∑–Ω—è—é—â–µ–π –æ–∫–µ–∞–Ω. –°–ª–µ–≤–∞ - –∞–∫—Ç–∏–≤–∏—Å—Ç.', left: {label:'–ê–ö–¢–ò–í–ò–°–¢', desc:'–°–ø–∞—Å—Ç–∏ –±–∏–∑–Ω–µ—Å', stats: {util: -20, ego: 20}}, right: {label:'CEO', desc:'–°–ø–∞—Å—Ç–∏ –ø—Ä–∏—Ä–æ–¥—É', stats: {util: 20, ego: -10}} },
            { id: 'p2', category: 'POLITIC', emoji: 'üè≥Ô∏è', title: '–°–≤–æ–π/–ß—É–∂–æ–π', desc: '–ì—Ä—É–ø–ø–∞ –≥—Ä–∞–∂–¥–∞–Ω –≤–∞—à–µ–π —Å—Ç—Ä–∞–Ω—ã vs –ì—Ä—É–ø–ø–∞ –∏–Ω–æ—Å—Ç—Ä–∞–Ω—Ü–µ–≤ (–≤ 2 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ).', left: {label:'–ß–£–ñ–ò–ï', desc:'–°–ø–∞—Å—Ç–∏ —Å–≤–æ–∏—Ö', stats: {ego: 40, util: -30}}, right: {label:'–°–í–û–ò', desc:'–°–ø–∞—Å—Ç–∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ', stats: {ego: -40, util: 30}} },
        ];

        createApp({
            setup() {
                const maxTime = 10.0;
                const timeLeft = ref(maxTime);
                const timerInterval = ref(null);
                
                const gameStatus = ref('start'); // start, playing, end
                const deck = ref([]);
                const currentCardIndex = ref(0);
                
                // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–∞
                const stats = ref({
                    util: 50,  // –£—Ç–∏–ª–∏—Ç–∞—Ä–∏–∑–º (–ü–æ–ª—å–∑–∞)
                    deon: 50,  // –î–µ–æ–Ω—Ç–æ–ª–æ–≥–∏—è (–î–æ–ª–≥/–ü—Ä–∞–≤–∏–ª–∞)
                    ego: 20,   // –≠–≥–æ–∏–∑–º
                    chaos: 10, // –•–∞–æ—Å
                    logic: 50  // –õ–æ–≥–∏–∫–∞
                });

                // Drag logic
                const isDragging = ref(false);
                const startX = ref(0);
                const currentX = ref(0);
                const screenWidth = window.innerWidth;
                const threshold = 100;
                
                // Glitch effect
                const glitchActive = ref(false);
                const timeOutTriggered = ref(false);

                // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ–ª–æ–¥—ã (shuffle + pick 15)
                const prepareDeck = () => {
                    const shuffled = [...SCENARIO_DB].sort(() => 0.5 - Math.random());
                    deck.value = shuffled.slice(0, 15); // –ë–µ—Ä–µ–º 15 –∫–∞—Ä—Ç –Ω–∞ –∏–≥—Ä—É
                };

                const activeScenario = computed(() => deck.value[currentCardIndex.value]);
                const nextCard = computed(() => deck.value[currentCardIndex.value + 1]);

                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–æ–º
                const startTimer = () => {
                    timeLeft.value = maxTime;
                    glitchActive.value = true; 
                    // –ù–µ–±–æ–ª—å—à–æ–π –≥–ª–∏—Ç—á –≤ –Ω–∞—á–∞–ª–µ –∫–∞—Ä—Ç—ã
                    setTimeout(() => glitchActive.value = false, 800);

                    clearInterval(timerInterval.value);
                    timerInterval.value = setInterval(() => {
                        timeLeft.value -= 0.1;
                        if (timeLeft.value <= 0) {
                            handleTimeOut();
                        }
                    }, 100);
                };

                const handleTimeOut = () => {
                    clearInterval(timerInterval.value);
                    timeOutTriggered.value = true;
                    
                    // –®—Ç—Ä–∞—Ñ—ã –∑–∞ –ø—Ä–æ–º–µ–¥–ª–µ–Ω–∏–µ
                    stats.value.chaos += 20;
                    stats.value.logic -= 20;

                    // –ê–≤—Ç–æ-–≤—ã–±–æ—Ä (—Ä–∞–Ω–¥–æ–º) —á–µ—Ä–µ–∑ 1 —Å–µ–∫
                    setTimeout(() => {
                        const randomDir = Math.random() > 0.5 ? 'right' : 'left';
                        makeChoice(randomDir, true);
                        timeOutTriggered.value = false;
                    }, 1000);
                };

                // –°–≤–∞–π–ø –ª–æ–≥–∏–∫–∞
                const cardStyle = computed(() => {
                    if (!isDragging.value && currentX.value === 0) {
                        return {'--rot': '1deg'}; // For css animation
                    }
                    const rot = currentX.value * 0.05;
                    return {
                        transform: `translateX(${currentX.value}px) rotate(${rot}deg)`,
                        transition: isDragging.value ? 'none' : 'transform 0.5s cubic-bezier(0.2, 0.8, 0.2, 1)',
                        '--rot': `${rot}deg`
                    };
                });

                const choiceOpacity = computed(() => ({
                    right: currentX.value > 0 ? Math.min(currentX.value / 100, 1) : 0,
                    left: currentX.value < 0 ? Math.min(Math.abs(currentX.value) / 100, 1) : 0
                }));

                const startDrag = (e) => {
                    if(timeOutTriggered.value) return;
                    isDragging.value = true;
                    startX.value = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
                };

                const onMove = (e) => {
                    if (!isDragging.value) return;
                    const x = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
                    currentX.value = x - startX.value;
                };

                const onEnd = () => {
                    if (!isDragging.value) return;
                    isDragging.value = false;
                    if (currentX.value > threshold) makeChoice('right');
                    else if (currentX.value < -threshold) makeChoice('left');
                    else currentX.value = 0;
                };

                const makeChoice = (dir, auto = false) => {
                    if (!activeScenario.value) return;
                    clearInterval(timerInterval.value);

                    // –ê–Ω–∏–º–∞—Ü–∏—è —É—Ö–æ–¥–∞
                    const flyX = dir === 'right' ? screenWidth + 300 : -screenWidth - 300;
                    currentX.value = flyX;

                    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∞—Ç—ã
                    const choiceStats = activeScenario.value[dir].stats;
                    for (const [k, v] of Object.entries(choiceStats)) {
                        if (stats.value[k] !== undefined) {
                            stats.value[k] = Math.min(100, Math.max(0, stats.value[k] + v));
                        }
                    }

                    // –°–ª–µ–¥—É—é—â–∞—è –∫–∞—Ä—Ç–∞
                    setTimeout(() => {
                        currentX.value = 0;
                        currentCardIndex.value++;
                        if (currentCardIndex.value < deck.value.length) {
                            startTimer();
                        } else {
                            endGame();
                        }
                    }, 400);
                };

                // Lifecycle
                const startGame = () => {
                    stats.value = { util: 50, deon: 50, ego: 20, chaos: 10, logic: 50 };
                    prepareDeck();
                    currentCardIndex.value = 0;
                    gameStatus.value = 'playing';
                    startTimer();
                };

                const endGame = () => {
                    gameStatus.value = 'end';
                    clearInterval(timerInterval.value);
                };

                const restartGame = () => {
                    gameStatus.value = 'start';
                };

                // Helpers
                const getRandomChars = (len) => {
                    const chars = 'ABCDEF0123456789!@#$%^&*';
                    let res = '';
                    for(let i=0; i<len; i++) res += chars[Math.floor(Math.random() * chars.length)];
                    return res;
                };

                const getStatName = (k) => ({util:'–û–±—â–µ–µ –±–ª–∞–≥–æ', deon:'–ö–æ–¥–µ–∫—Å —á–µ—Å—Ç–∏', ego:'–í—ã–∂–∏–≤–∞–Ω–∏–µ', chaos:'–≠–Ω—Ç—Ä–æ–ø–∏—è', logic:'–õ–æ–≥–∏–∫–∞'}[k]);
                
                const getBarColor = (k) => ({
                    util: 'bg-blue-500', deon: 'bg-purple-500', ego: 'bg-yellow-500', chaos: 'bg-red-500', logic: 'bg-green-500'
                }[k]);

                // –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                const resultData = computed(() => {
                    const s = stats.value;
                    if (s.chaos > 70) return { emoji: 'üí•', title: '–°–ò–°–¢–ï–ú–ù–ê–Ø –û–®–ò–ë–ö–ê', desc: '–í–∞—à–∏ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏–≤–µ–ª–∏ –∫ –∫–æ–ª–ª–∞–ø—Å—É –æ–±—â–µ—Å—Ç–≤–∞. –ü–æ–ª–Ω–∞—è –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å.' };
                    if (s.ego > 70) return { emoji: 'üê∫', title: '–•–ò–©–ù–ò–ö', desc: '–í—ã –≤—ã–∂–∏–≤–µ—Ç–µ –≤ –ª—é–±–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏. –û—Å—Ç–∞–ª—å–Ω—ã–µ ‚Äî –ø—Ä–æ—Å—Ç–æ —Ä–µ—Å—É—Ä—Å—ã.' };
                    if (s.util > 70) return { emoji: '‚öôÔ∏è', title: '–ê–†–ò–§–ú–û–ú–ï–¢–†', desc: '–ñ–∏–∑–Ω—å –¥–ª—è –≤–∞—Å ‚Äî —ç—Ç–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞. 5 > 1, –≤—Å–µ–≥–¥–∞. –ù–∏–∫–∞–∫–∏—Ö —á—É–≤—Å—Ç–≤.' };
                    if (s.deon > 70) return { emoji: 'üõ°Ô∏è', title: '–ü–ê–õ–ê–î–ò–ù', desc: '–í—ã —Å–ª–µ–¥—É–µ—Ç–µ –ø—Ä–∞–≤–∏–ª–∞–º –¥–∞–∂–µ –∫–æ–≥–¥–∞ –º–∏—Ä —Ä—É—à–∏—Ç—Å—è. –ü—Ä–∏–Ω—Ü–∏–ø—ã –≤–∞–∂–Ω–µ–µ –∂–∏–∑–Ω–µ–π.' };
                    if (s.logic > 80) return { emoji: 'üß†', title: '–°–í–ï–†–•–†–ê–ó–£–ú', desc: '–í–∞—à–∏ —Ä–µ—à–µ–Ω–∏—è —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ª—é–¥—å–º–∏.' };
                    return { emoji: 'üë§', title: '–°–ò–ú–£–õ–Ø–¶–ò–Ø –ß–ï–õ–û–í–ï–ö–ê', desc: '–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–≤—ã–π –ø—Ä–æ—Ñ–∏–ª—å. –ü–æ—á—Ç–∏ –∫–∞–∫ –Ω–∞—Å—Ç–æ—è—â–∏–π.' };
                });

                onMounted(() => {
                    window.addEventListener('mousemove', onMove);
                    window.addEventListener('mouseup', onEnd);
                    window.addEventListener('touchmove', onMove);
                    window.addEventListener('touchend', onEnd);
                });
                
                return {
                    gameStatus, timeLeft, maxTime, activeScenario, nextCard, stats,
                    cardStyle, choiceOpacity, isDragging, timeOutTriggered, glitchActive,
                    startDrag, startGame, restartGame, resultData, getStatName, getBarColor, getRandomChars
                };
            }
        }).mount('#app');
    </script>
</body>
</html>